# 메모리 누수

웹 페이지 내에서 무거운 자바스크립트 코드 사용사에 페이지 성능에 영향을 미치는 메모리 문제를 찾아내는 방법을 알아본다.  
_**메모리 누수**_, _**메모리 팽창**_, _**잦은 가비지 수집**_ 등이 대표적인 원인으로 꼽힌다.

## 요약 (TL;DR)

* 크롬 작업관리자를 사용하여 확인 가능
* 시간의 흐름에 따른 메모리 사용량을 타임라인으로 기록하여 시각화한다.
* 분리된 DOM 트리 (일반적인 메모리 누수 원인) 을 힙 스냅샷으로 식별할 수 있다.
* JS 힙에 새 메모리가 할당될 때 할당 타임라인 기록을 확인하여 알아낼 수 있다.

## 메모리 팽창과 누수의 판별

단순히 사이트의 점점 더 많은 메모리를 사용하게 된다면 누수가 발생된다고 볼 수 있다.  
여기서 많은 메모리의 기준은 RAIL 모델을 사용하여 사용자에게 주안점을 두는것이다.

> ### RAIL 모델
> 사용자 중신의 성능 모델로 다음 네가지의 측면을 반영한다.
> * Response
>   * 사용자의 입력은 100ms 내에 인지해야 함
> * Animation
>   * 애니메이션의 스크롤 시간을 10ms 이내에 프레임을 생성해야 함
> * Idle
>   * 메인 스레드의 유휴시간을 극대화 해야 함
> * Load
>   * 대화형 콘텐츠의 경우 1000ms 이내에 전달해야 함

## 크롬 (Chrome) 의 작업 관리자로 메모리 사용량을 실시간 모니터링

## 타임라인 (Timeline) 기록으로 메모리 누수의 시각화

## 힙 스냅샷으로 분리된 DOM 트리 메모리 누수의 발견

## Javascript 힙 (Heap) 메모리 누수 파악 (Allocation Timeline)

## 함수별 메모리 할당 관측

## 잦은 가비지 수집 관측

> ### 참고자료
> <https://developers.google.com/web/tools/chrome-devtools/memory-problems/?hl=ko>
> <https://developers.google.com/web/fundamentals/performance/rail?hl=ko>